<div class="min-h-screen flex flex-col bg-slate-950 text-slate-50">
  <header class="sticky top-0 z-30 border-b border-slate-800 bg-slate-900/80 backdrop-blur">
    <div class="mx-auto flex max-w-5xl items-center justify-between gap-4 px-4 py-3 md:px-6">
      <!-- Left: logo / brand -->
      <div class="flex items-center gap-3">
        <div class="flex items-center gap-2">
          <div
            class="flex h-8 w-8 items-center justify-center rounded-2xl bg-indigo-500 text-xs font-bold text-white shadow-lg shadow-indigo-500/40"
          >
            TV
          </div>
          <div class="flex flex-col">
            <span class="text-sm font-semibold tracking-tight">
              TurboVets Tasker
            </span>
            <span class="hidden text-[11px] text-slate-400 sm:inline">
              Multi-clinic task management
            </span>
          </div>
        </div>
      </div>

      <!-- Right: when logged in -->
      <div
        class="flex items-center gap-4"
        *ngIf="isLoggedIn; else loggedOut"
      >
        <!-- User + role (desktop) -->
        <div class="hidden flex-col items-end text-xs md:flex">
          <span class="text-slate-200">
            {{ email }}
          </span>
          <span
            class="text-[11px] text-slate-400"
            *ngIf="currentOrgRole"
          >
            Role: {{ currentOrgRole }}
          </span>
        </div>

        <!-- Org selector -->
        <ng-container *ngIf="organizations?.length">
          <!-- Desktop org selector -->
          <div class="hidden flex-col text-right text-[11px] text-slate-400 md:flex">
            <span class="mb-1">Organization</span>
            <select
              class="w-56 rounded-lg border border-slate-800 bg-slate-950/70 px-3 py-1.5 text-xs text-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
              [value]="currentOrgId || ''"
              (change)="onOrgChange($event)"
            >
              <option
                *ngFor="let org of organizations"
                [value]="org.organizationId"
              >
                {{ org.organizationName }} ({{ org.role }})
              </option>
            </select>
          </div>

          <!-- Mobile org selector -->
          <div class="flex items-center gap-2 md:hidden">
            <select
              class="w-40 rounded-lg border border-slate-800 bg-slate-950/70 px-2 py-1.5 text-[11px] text-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
              [value]="currentOrgId || ''"
              (change)="onOrgChange($event)"
            >
              <option
                *ngFor="let org of organizations"
                [value]="org.organizationId"
              >
                {{ org.organizationName }} ({{ org.role }})
              </option>
            </select>
          </div>
        </ng-container>

        <!-- Nav -->
        <nav
          class="hidden items-center gap-1 rounded-full border border-slate-800 bg-slate-900/80 p-0.5 text-[11px] font-medium text-slate-300 md:flex"
        >
          <a
            class="inline-flex items-center rounded-full px-3 py-1.5 transition-colors hover:bg-slate-800"
            routerLink="/tasks"
            routerLinkActive="bg-slate-800 text-slate-50"
            [routerLinkActiveOptions]="{ exact: true }"
          >
            Tasks
          </a>
          <a
            class="inline-flex items-center rounded-full px-3 py-1.5 transition-colors hover:bg-slate-800"
            routerLink="/org-users"
            routerLinkActive="bg-slate-800 text-slate-50"
          >
            Org users
          </a>
        </nav>

        <!-- Logout -->
        <button
          class="inline-flex items-center rounded-lg px-3 py-1.5 text-xs font-medium text-slate-200 hover:bg-slate-800/80"
          (click)="logout()"
        >
          Logout
        </button>
      </div>

      <!-- When logged out -->
      <ng-template #loggedOut>
        <div class="flex items-center gap-3">
          <a
            routerLink="/login"
            class="inline-flex items-center rounded-lg bg-indigo-500 px-3 py-1.5 text-xs font-semibold text-white shadow-sm shadow-indigo-500/40 hover:bg-indigo-400"
          >
            Sign in
          </a>
        </div>
      </ng-template>
    </div>
  </header>

  <main class="flex-1 px-4 py-6 md:px-6">
    <div class="mx-auto flex w-full max-w-5xl flex-col gap-6">
      <router-outlet></router-outlet>
    </div>
  </main>
</div>
